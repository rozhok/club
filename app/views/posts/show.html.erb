<% content_for(:title) {"#{@post.title} | –†—ñ–∂–æ–∫ –ö–ª—É–±"} %>
<% content_for(:og_image) {@post.og_image} %>
<% content_for(:og_description) {@post.og_description} %>
<div class="container mx-auto w-7/8">
  <div class="card card-border shadow-sm mb-8">
    <div class="card-body prose text-black !max-w-none">
      <% case @post.state %>
      <% when "pending" %>
        <div role="alert" class="alert alert-warning">
          <%= inline_svg_tag "icons/warning.svg" %>
          <span>–ü–æ—Å—Ç –æ—á—ñ–∫—É—î —Å—Ö–≤–∞–ª–µ–Ω–Ω—è</span>
        </div>
      <% when "rejected" %>
        <div role="alert" class="alert alert-error">
          <%= inline_svg_tag "icons/warning.svg" %>
          <span>–ü–æ—Å—Ç –ø–æ—Ç—Ä–µ–±—É—î –¥–æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è</span>
        </div>
      <% end %>
      <h1 class="!mb-0 text-3xl font-bold text-center"><%= @post.full_title %></h1>
      <h3 class="text-md text-center text-gray-700 mt-0">
        <% if @post.is_public? %>
          <span>üåé</span><span>–ü—É–±–ª—ñ—á–Ω–∏–π –ø–æ—Å—Ç</span>
        <% else %>
          <span>üîê</span><span>–¢—ñ–ª—å–∫–∏ –¥–ª—è —Å–≤–æ—ó—Ö</span>
        <% end %>
      </h3>
      <h4 class="text-sm text-center text-gray-500 mt-0"><%= l(@post.created_at.to_date, locale: :uk) %></h4>
      <%= render partial: "votes/post_vote", locals: { post: @post } %>
      <% if @post.post_type == "link" || @post.post_type == "project" %>
        <h2 class="!mb-0 !mt-0 text-xl font-bold">
          <span>üëâ</span><%= link_to @post.link, @post.link.html_safe, class: "link" %></h2>
      <% end %>
      <%= @post.content %>
    </div>

    <div class="card-actions justify-end p-4 pt-0 pr-6">
      <% if @post.state == "pending" %>
        <% if can? :approve, Post %>
          <%= button_to approve_post_path(@post), method: :patch, class: "btn btn-sm btn-success btn-outline" do %>
            <span>‚úÖ</span><span>–ó–∞—Ç–≤–µ—Ä–¥–∏—Ç–∏</span>
          <% end %>
        <% end %>
        <% if can? :reject, Post %>
          <%= button_to reject_post_path(@post), method: :patch, class: "btn btn-sm btn-warning btn-outline" do %>
            <span>‚ùå</span><span>–ù–∞ –¥–æ–æ–ø—Ä–∞—Ü—é–≤–∞–Ω–Ω—è</span>
          <% end %>
        <% end %>
      <% end %>
      <% if can? :update, @post %>
        <%= link_to edit_post_path(@post.id), class: "btn btn-sm btn-neutral btn-outline" do %>
          <span>üìù</span><span>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</span>
        <% end %>
      <% end %>
    </div>
  </div>

  <%= render partial: "users/profile", locals: { user: @post.user } %>

  <h2 id="comments" class="text-xl mb-8">–ö–æ–º–µ–Ω—Ç–∞—Ä—ñüëá</h2>

  <% if can? :read, Comment %>
    <%= turbo_frame_tag "new_comment_form" do %>
      <%= render partial: "comments/form", locals: { post: @post, comment: @post.comments.build } %>
    <% end %>
  <% end %>

  <%= render @comments %>

  <%= turbo_frame_tag Comment.new %>
</div>
